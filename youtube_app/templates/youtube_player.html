{% extends "base.html" %}
{% load static %}
{% block content %}
{% load static %}

<head>
    <script src="static/js/jquery-3.5.1.min.js"></script>
    <script src="static/js/popper.js"></script>
    <script src="static/js/bootstrap/bootstrap.min.js"></script>
    <script src="static/js/grid.js"></script>
</head>

<section id="main-body" class="main-body">
    <section class="player-container-index ">
        <section class="videoplayer-index">
            <section class="main-video-index">
                <div class="player" id="player">
                    <script>

                    tag = document.createElement('script');

                    tag.src = "https://www.youtube.com/iframe_api";
                    firstScriptTag = document.getElementsByTagName('script')[0];
                    firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

                    function onYouTubeIframeAPIReady() {
                        player = new YT.Player('player', {
                        height: '360',
                        width: '640',
                        playerVars: {'autoplay': 0, 'loop': 1},
                        events: {
                            'onReady': onPlayerReady,
                            'onStateChange': onPlayerStateChange
                            },
                        });
                    }

                    function onPlayerReady(event) {
                        event.target.loadVideoById( {
                                                      'videoId': '{{ video_id }}',
                                                      'startSeconds': '{{ start_video }}',
                                                      'endSeconds': '{{ stop_video }}',
                                                      'suggestedQuality': 'small',
                                                      });
                    }

                    function onPlayerStateChange(event) {
                        if (event.data == YT.PlayerState.ENDED) {
                            event.target.loadVideoById({
                                                        'videoId': '{{video_id}}',
                                                        'startSeconds': '{{ start_video }}',
                                                        'endSeconds': '{{ stop_video }}',
                                                        'suggestedQuality': 'small',
                                                        });
                        }
                    }

                    </script>
                </div>
            </section>
        </section>
    </section>

    <section class="looper">

        <span id="lopper-timer">00:00</span>
        <div class="middle">
            <div class="multi-range-slider">
                <form id="loop" action="" method="POST">
                    {% csrf_token %}
                    <input type="range" name="start_value" id="input-left" min="0" max="{{ length }}" value={{
                           start_video }} oninput="leftfunction()">
                    <input type="range" name="stop_value" id="input-right" min="{{ 0 }}" max="{{ length }}" value={{
                           stop_video }}>

                </form>
                <div class="slider">
                    <div class="track"></div>
                    <div class="range"></div>
                    <div class="thumb left"></div>
                    <div class="thumb right"></div>
                </div>


            </div>
        </div>
    </section>
    <div class="text-center">
        <button type="submit" form="loop" id="btn-looper-play" class="btn-looper-play">
            <i id="i-looper-play" class="fa fa-play"></i>
        </button>
        <button id="btn-looper-pause" class="btn-looper-pause ">
            <i id="i-looper-pause" class="fa fa-pause "></i>
        </button>
    </div>

    <p>START: <span id="startvalue"></span> STOP: <span id="stopvalue"></span></p>


    <script>
        var sliderl = document.getElementById("input-left");
        var outputl = document.getElementById("startvalue");
        outputl.innerHTML = Math.floor(sliderl.value/60) +" : "+ sliderl.value%60;

            sliderl.oninput = function() {
                                       outputl.innerHTML = Math.floor(this.value/60) +" : "+ this.value%60 ;
                                }

    </script>
    <script>
        var sliderr = document.getElementById("input-right");
        var outputr = document.getElementById("stopvalue");
        outputr.innerHTML = Math.floor(sliderr.value/60) +" : "+ sliderr.value%60;

            sliderr.oninput = function() {
                                            outputr.innerHTML = Math.floor(this.value/60) +" : "+ this.value%60
                                }

    </script>

</section>
{% endblock %}


